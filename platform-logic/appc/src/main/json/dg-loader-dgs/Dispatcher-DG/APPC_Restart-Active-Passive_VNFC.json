[{"id":"565d7830.671f38","type":"dgstart","name":"DGSTART","outputs":1,"x":120,"y":46,"z":"3fd3b806.3e5988","wires":[["ac4eea18.913ab8"]]},{"id":"59101988.5e8918","type":"method","name":"Restart-Active-Passive_VNFC","xml":"<method rpc='Restart-Active-Passive_VNFC' mode='sync'>\n","comments":"","outputs":1,"x":140,"y":169,"z":"3fd3b806.3e5988","wires":[["794ec84e.03f458"]]},{"id":"ac4eea18.913ab8","type":"service-logic","name":"APPC 2.0.0","module":"APPC","version":"2.0.0","comments":"","xml":"<service-logic xmlns='http://www.onap.org/sdnc/svclogic' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='http://www.onap.org/sdnc/svclogic ./svclogic.xsd' module='APPC' version='2.0.0'>","outputs":1,"x":301,"y":45,"z":"3fd3b806.3e5988","wires":[["59101988.5e8918"]]},{"id":"794ec84e.03f458","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":213.10713958740234,"y":1121.833251953125,"z":"3fd3b806.3e5988","wires":[["4be16fa8.af873","e7b3ea7a.c2c148","fcff96c4.ade008","1c612bb4.7e9b94","f4113929.049f68","c5cfc802.b4cf68","3a78a34c.56b16c","b35d1ce3.c179b","1ba5abd.58e3954","bbe6528e.9f013","6c87077e.9e46d8"]]},{"id":"1c67b9e.8d46346","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":782.4375,"y":246.1875,"z":"3fd3b806.3e5988","wires":[["49de287f.6f6438","83c8d474.49add8","dfe164aa.2d4e48"]]},{"id":"49de287f.6f6438","type":"for","name":"for_each_vm","xml":"<for index='i' start='0' end='`$vmCount`' >","comments":"","outputs":1,"x":956.9376068115234,"y":163.6875,"z":"3fd3b806.3e5988","wires":[["439a312b.1157c"]]},{"id":"dfe164aa.2d4e48","type":"set","name":"set","xml":"<set>\n<parameter name=\"healthcheck.vmCount\" value=\"`$vmCount`\" />\n<parameter name=\"retry-healthcheck\" value=\"false\"/>\n","comments":"","x":1000.6875152587891,"y":245.9373836517334,"z":"3fd3b806.3e5988","wires":[]},{"id":"83c8d474.49add8","type":"call","name":"call_vnfc_healthcheck_dg","xml":"<call rpc='`$HealthCheckDG.dg_name`' version='`$HealthCheckDG.dg_version`' module='`$HealthCheckDG.dg_module`' mode='sync' >\n","comments":"","outputs":1,"x":962.7422485351562,"y":317.4207763671875,"z":"3fd3b806.3e5988","wires":[["14a8bba.80caa44","fd8d5af4.7df798","fff32611.8ae708"]]},{"id":"14a8bba.80caa44","type":"outcome","name":"healthcheck_failed","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1225.4375610351562,"y":264.9375,"z":"3fd3b806.3e5988","wires":[["ae67c815.dcdce8"]]},{"id":"fd8d5af4.7df798","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1200.9542846679688,"y":317.2757568359375,"z":"3fd3b806.3e5988","wires":[["fa98825d.3010c"]]},{"id":"fff32611.8ae708","type":"outcome","name":"healthcheck_success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1229.7233276367188,"y":368.7589111328125,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"98d9e8d0.be81a8","type":"comment","name":"Healthcheck VMs","info":"","comments":"","x":492.6597900390625,"y":199.29833984375,"z":"3fd3b806.3e5988","wires":[]},{"id":"439a312b.1157c","type":"set","name":"set","xml":"<set>\n<parameter name=\"healthcheck.vm[$i].url\" value=\"`$vm[$i].url`\" />\n","comments":"","x":1104.0765571594238,"y":162.71521377563477,"z":"3fd3b806.3e5988","wires":[]},{"id":"fa98825d.3010c","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1581.8818969726562,"y":313.1596670150757,"z":"3fd3b806.3e5988","wires":[["4059468e.bea478","3662a5a.682225a","94c4b9c3.257ef8","2c062cf5.3f4d74"]]},{"id":"2c062cf5.3f4d74","type":"set","name":"Set event message","xml":"<set>\n<parameter name='event-message' value=\"VNFC Health check DG not found\"/>","comments":"","x":1978.7986450195312,"y":247.65954399108887,"z":"3fd3b806.3e5988","wires":[]},{"id":"94c4b9c3.257ef8","type":"record","name":"Log event","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"level\" value=\"error\"/>\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"record\" value=\"`$event-message`\"/>\n","comments":"","outputs":1,"x":1953.5149536132812,"y":320.72228813171387,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"4059468e.bea478","type":"execute","name":"OutputMessageBuilder","xml":"<execute plugin='org.openecomp.appc.dg.common.OutputMessagePlugin' method='outputMessageBuilder' >\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n<parameter name=\"event-message\" value=\"`$event-message`\" />","comments":"","outputs":1,"x":2043.3825073242188,"y":366.6596984863281,"z":"3fd3b806.3e5988","wires":[["52451ef0.748c5"]]},{"id":"3662a5a.682225a","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n","comments":"","x":1959.3928833007812,"y":409.5977153778076,"z":"3fd3b806.3e5988","wires":[]},{"id":"ae67c815.dcdce8","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1585.8818969726562,"y":260.1596670150757,"z":"3fd3b806.3e5988","wires":[["94c4b9c3.257ef8","4059468e.bea478","3662a5a.682225a"]]},{"id":"4be16fa8.af873","type":"switchNode","name":"switch_any_vm_to_healthcheck","xml":"<switch test='`$vmCount>=1`'>\n","comments":"","outputs":1,"x":507.96527099609375,"y":247.4375,"z":"3fd3b806.3e5988","wires":[["9613c9c6.03d988","584f2018.2bde8"]]},{"id":"9613c9c6.03d988","type":"other","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":662.9652862548828,"y":181.43753147125244,"z":"3fd3b806.3e5988","wires":[["1c67b9e.8d46346"]]},{"id":"584f2018.2bde8","type":"outcomeTrue","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":678.9652709960938,"y":343.4375,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"4724f50a.19007c","type":"execute","name":"Resolve_Check-Active_VNFC_vSCP","xml":"<execute plugin='org.openecomp.appc.dg.common.VNFCDgResolverPlugin' method='resolveVNFCDg'>\n<parameter name=\"vnfType\" value='`$vnf.type`' />\n<parameter name=\"vnfcType\" value='`$vnfcType`' />\n<parameter name=\"action\" value=\"IsActive\" />\n<parameter name=\"api-ver\" value='`$input.common-header.api-ver`' />\n<parameter name=\"prefix\" value=\"IsActiveDG\" />\n","comments":"","outputs":1,"x":1379.895980834961,"y":652.5207901000977,"z":"3fd3b806.3e5988","wires":[["1130e674.0489ea","2eb496e0.0cef8a","79cfc4c5.caf0ac"]]},{"id":"9cd35f9f.becbb","type":"call","name":"call_checkActive_DG","xml":"<call rpc='`$IsActiveDG.dg_name`' version='`$IsActiveDG.dg_version`' module='`$IsActiveDG.dg_module`' mode='sync' >\n","comments":"","outputs":1,"x":1750.6736450195312,"y":827.6320190429688,"z":"3fd3b806.3e5988","wires":[["f1fd8fe2.c9c05","fde23278.98f7d","fc061fd9.a985d"]]},{"id":"52572003.4e273","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"false","comments":"","outputs":1,"x":1709.7014770507812,"y":759.6875,"z":"3fd3b806.3e5988","wires":[["9cd35f9f.becbb"]]},{"id":"1130e674.0489ea","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1600.8959350585938,"y":704.5208129882812,"z":"3fd3b806.3e5988","wires":[["52572003.4e273"]]},{"id":"2eb496e0.0cef8a","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1614.8958129882812,"y":607.5208129882812,"z":"3fd3b806.3e5988","wires":[["5c094025.a30ec"]]},{"id":"79cfc4c5.caf0ac","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1625.8958740234375,"y":655.5208435058594,"z":"3fd3b806.3e5988","wires":[["be24d9c9.561338"]]},{"id":"5c094025.a30ec","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1796.1182250976562,"y":604.939697265625,"z":"3fd3b806.3e5988","wires":[["f306145d.fdc398","5c26451c.10c92c","2e7608a5.5732a8","d8d5bc0a.b708c"]]},{"id":"f306145d.fdc398","type":"set","name":"Set event message","xml":"<set>\n<parameter name='event-message' value=\"`'IsActive DG resolution plugin not found for VNFC : ' + $vnfcName`\"/>\n","comments":"","x":2047.8960571289062,"y":540.5208129882812,"z":"3fd3b806.3e5988","wires":[]},{"id":"be24d9c9.561338","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1767.1182250976562,"y":656.4097900390625,"z":"3fd3b806.3e5988","wires":[["a229ed4e.0dcb6","5c26451c.10c92c","2e7608a5.5732a8","d8d5bc0a.b708c"]]},{"id":"a229ed4e.0dcb6","type":"set","name":"Set event message","xml":"<set>\n<parameter name='event-message' value=\"`'Error while resolving IsActive DG for VNFC : ' + $vnfcName`\"/>\n","comments":"","x":2062.1179809570312,"y":578.4097900390625,"z":"3fd3b806.3e5988","wires":[]},{"id":"5c26451c.10c92c","type":"record","name":"Log event","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"level\" value=\"error\"/>\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"record\" value=\"`$event-message`\"/>\n","comments":"","outputs":1,"x":2084.6869506835938,"y":620.7096557617188,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"2e7608a5.5732a8","type":"execute","name":"OutputMessageBuilder","xml":"<execute plugin='org.openecomp.appc.dg.common.OutputMessagePlugin' method='outputMessageBuilder' >\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n<parameter name=\"event-message\" value=\"`$event-message`\" />","comments":"","outputs":1,"x":2203.5545043945312,"y":671.89697265625,"z":"3fd3b806.3e5988","wires":[["52451ef0.748c5"]]},{"id":"d8d5bc0a.b708c","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-message' value=\"`$error-message`\"/>","comments":"","x":2079.6736450195312,"y":719.8798217773438,"z":"3fd3b806.3e5988","wires":[]},{"id":"f27f6bc.1549998","type":"comment","name":"Check Active Passive Status","info":"","comments":"","x":1373.5347900390625,"y":615.4929504394531,"z":"3fd3b806.3e5988","wires":[]},{"id":"fde23278.98f7d","type":"other","name":"other","xml":"<outcome value='Other'>\n","comments":"","outputs":1,"x":1946.2570190429688,"y":828.6876220703125,"z":"3fd3b806.3e5988","wires":[["211d3f71.d278e"]]},{"id":"211d3f71.d278e","type":"block","name":"block","xml":"<block>","atomic":"false","comments":"","outputs":1,"x":2078.5066528320312,"y":828.076416015625,"z":"3fd3b806.3e5988","wires":[["57792db1.3c8d24","1f3a0577.6a147b","45ded8ec.fc9338"]]},{"id":"f1fd8fe2.c9c05","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1949.7850952148438,"y":771.1319580078125,"z":"3fd3b806.3e5988","wires":[["9bcb3092.a9072"]]},{"id":"9bcb3092.a9072","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2087.4519653320312,"y":770.7730712890625,"z":"3fd3b806.3e5988","wires":[["ab89d5f6.5f6638","57792db1.3c8d24","45ded8ec.fc9338","1f3a0577.6a147b"]]},{"id":"ab89d5f6.5f6638","type":"set","name":"Set event message","xml":"<set>\n<parameter name='event-message' value=\"`'IsActive DG not found for VNFC : ' + $vnfcName`\"/>\n","comments":"","x":2306.0073852539062,"y":750.354248046875,"z":"3fd3b806.3e5988","wires":[]},{"id":"57792db1.3c8d24","type":"record","name":"Log event","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"level\" value=\"error\"/>\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"record\" value=\"`$event-message`\"/>\n","comments":"","outputs":1,"x":2315.8960571289062,"y":793.0208740234375,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"45ded8ec.fc9338","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-message' value=\"`$error-message`\"/>","comments":"","x":2308.6738891601562,"y":886.6875610351562,"z":"3fd3b806.3e5988","wires":[]},{"id":"fc061fd9.a985d","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1949.3959350585938,"y":903.4931030273438,"z":"3fd3b806.3e5988","wires":[["a5bcdddf.bc981"]]},{"id":"a5bcdddf.bc981","type":"block","name":"block","xml":"<block>","atomic":"false","comments":"","outputs":1,"x":2096.1179809570312,"y":903.85400390625,"z":"3fd3b806.3e5988","wires":[["d6962e57.fda47"]]},{"id":"d6962e57.fda47","type":"record","name":"Log success","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"level\" value=\"error\"/>\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"record\" value=\"Active/Passive check succeeded\"/>\n","comments":"","outputs":1,"x":2283.0901489257812,"y":937.742919921875,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"e7b3ea7a.c2c148","type":"execute","name":"executePreRestart","xml":"<execute plugin='com.att.appc.dg.vSCP.v3_5_5.smp.SMPDGPlugin' method='restartSequenceGenerator' >\n","comments":"","outputs":1,"x":700.8542175292969,"y":846.7710266113281,"z":"3fd3b806.3e5988","wires":[["ff4b13d7.8ff6a","6e82fb15.444774","96ac29bf.e4a348"]]},{"id":"e598a9ef.046f68","type":"for","name":"for_each_vm","xml":"<for index=\"i\" start=\"0\" end=\"`$vmCount`\" >","comments":"","outputs":1,"x":873.5207977294922,"y":499.30663871765137,"z":"3fd3b806.3e5988","wires":[["794de1af.7fd7e"]]},{"id":"5ef368c3.4bd7b8","type":"switchNode","name":"switch : healthcheck status","xml":"<switch test=\"`$healthcheck.vm[$i].status`\">\n","comments":"","outputs":1,"x":1294.5206909179688,"y":498.8065776824951,"z":"3fd3b806.3e5988","wires":[["f2e22899.360288","433d325f.0e0b7c","21588e29.a3cc32"]]},{"id":"f2e22899.360288","type":"other","name":"outcome_up","xml":"<outcome value='UP'>\n","comments":"","outputs":1,"x":1541.5206909179688,"y":541.3066387176514,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"21588e29.a3cc32","type":"other","name":"outcome_down","xml":"<outcome value='DOWN'>\n","comments":"","outputs":1,"x":1557.5206909179688,"y":451.30663871765137,"z":"3fd3b806.3e5988","wires":[["5950449e.d1cb4c"]]},{"id":"433d325f.0e0b7c","type":"other","name":"outcome_unknown","xml":"<outcome value='UNKNOWN'>\n","comments":"","outputs":1,"x":1559.3041381835938,"y":498.4493999481201,"z":"3fd3b806.3e5988","wires":[["5950449e.d1cb4c"]]},{"id":"5124c756.7348b8","type":"set","name":"set","xml":"<set>\n<parameter name=\"doCheckActive\" value=\"true\" />\n","comments":"","x":871.8689727783203,"y":435.59222412109375,"z":"3fd3b806.3e5988","wires":[]},{"id":"5950449e.d1cb4c","type":"set","name":"set_to_perform_checkActive","xml":"<set>\n<parameter name=\"doCheckActive\" value=\"false\" />\n","comments":"","x":1830.0833129882812,"y":470.3065776824951,"z":"3fd3b806.3e5988","wires":[]},{"id":"60571aaf.8d8604","type":"switchNode","name":"switch_Perform_check_active","xml":"<switch test='`$doCheckActive`'>\n","comments":"","outputs":1,"x":928.0833129882812,"y":652.7709045410156,"z":"3fd3b806.3e5988","wires":[["4b2bdd82.af31c4","36d8fdb0.8d2aa2"]]},{"id":"4b2bdd82.af31c4","type":"other","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":1157.3333740234375,"y":653.5208435058594,"z":"3fd3b806.3e5988","wires":[["4724f50a.19007c"]]},{"id":"6e82fb15.444774","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":971.6667175292969,"y":904.7709655761719,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"ff4b13d7.8ff6a","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":948.1669464111328,"y":789.5208129882812,"z":"3fd3b806.3e5988","wires":[["6b9137e6.eeb0c8"]]},{"id":"3be108bc.20f958","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='401' />\n<parameter name='error-message' value='`$error-message`' />\n<parameter name='output.status.code' value='401'/>\n","comments":"","x":1368.2382507324219,"y":861.1994934082031,"z":"3fd3b806.3e5988","wires":[]},{"id":"30d0cd36.793752","type":"set","name":"set event message","xml":"<set>\n<parameter name='event-message' value='Pre-Restart Execution failed' />\n","comments":"","x":1387.9694519042969,"y":777.9878234863281,"z":"3fd3b806.3e5988","wires":[]},{"id":"691ca8da.821e88","type":"record","name":"Log event","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"level\" value=\"error\"/>\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"record\" value=\"`$event-message`\"/>\n","comments":"","outputs":1,"x":1366.9694519042969,"y":815.9878234863281,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"1c612bb4.7e9b94","type":"for","name":"for_first_list","xml":"<for index='vmIndex' start='0' end='`$vmCount`' >\n","comments":"","outputs":1,"x":486.75013732910156,"y":1122.166748046875,"z":"3fd3b806.3e5988","wires":[["38e206a3.cc06fa"]]},{"id":"25ad81f2.75882e","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1361.2500610351562,"y":1148.4169311523438,"z":"3fd3b806.3e5988","wires":[["3e050b23.00ef54"]]},{"id":"4d653382.a429ec","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1366.2501983642578,"y":1239.4169917106624,"z":"3fd3b806.3e5988","wires":[["fd9f91c4.d80c9"]]},{"id":"b35d1ce3.c179b","type":"switchNode","name":"switch_any_firstList_vm_restarted","xml":"<switch test='`$restartedFirstVMListCount>=1`'>\n","comments":"","outputs":1,"x":658.7777938842773,"y":1780.138671875,"z":"3fd3b806.3e5988","wires":[["c7ae14aa.457d88","2f4154b1.cffeac"]]},{"id":"c7ae14aa.457d88","type":"other","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":903.5277938842773,"y":1864.1387939453125,"z":"3fd3b806.3e5988","wires":[["90e673f0.925cf"]]},{"id":"2f4154b1.cffeac","type":"outcomeTrue","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":905.7777633666992,"y":1704.1387939453125,"z":"3fd3b806.3e5988","wires":[["4047d58d.27a18c"]]},{"id":"4047d58d.27a18c","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='' />\n<parameter name='error-message' value='' />\n","comments":"","x":1105.5278854370117,"y":1702.8887939453125,"z":"3fd3b806.3e5988","wires":[]},{"id":"b7d474af.5c9d58","type":"failure","name":"failure","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1849.000087738037,"y":1919.555528640747,"z":"3fd3b806.3e5988","wires":[["1601f900.8eba77"]]},{"id":"48e8232b.a696ec","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1867.000087738037,"y":2039.4445667266846,"z":"3fd3b806.3e5988","wires":[["a762c339.2cf29"]]},{"id":"db44a408.35fa18","type":"set","name":"Mark VM failed","xml":"<set>\n<parameter name=\"restartFailedCount\" value=\"`$restartFailedCount + 1`\" />\n","comments":"","x":1790.500015258789,"y":1061.1669917106624,"z":"3fd3b806.3e5988","wires":[]},{"id":"33b4c1af.2c1a5e","type":"record","name":"Log event","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"level\" value=\"error\"/>\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"record\" value=\"`$event-message`\"/>\n","comments":"","outputs":1,"x":1783.679702758789,"y":1104.6076655387874,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"e4f324e3.458468","type":"execute","name":"OutputMessageBuilder","xml":"<execute plugin='org.openecomp.appc.dg.common.OutputMessagePlugin' method='outputMessageBuilder' >\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n<parameter name=\"event-message\" value=\"`$event-message`\" />","comments":"","outputs":1,"x":1818.7965240478516,"y":1151.5446772575374,"z":"3fd3b806.3e5988","wires":[["52451ef0.748c5"]]},{"id":"3e050b23.00ef54","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":1541.7501373291016,"y":1147.91686964035,"z":"3fd3b806.3e5988","wires":[["db44a408.35fa18","33b4c1af.2c1a5e","e4f324e3.458468"]]},{"id":"f44e0dc2.7f05c","type":"set","name":"Set event message and update counters","xml":"<set>\n<parameter name=\"restartFailedCount\" value=\"`$restartFailedCount + 1`\" />\n","comments":"","x":2412.4722290039062,"y":1807.9716796875,"z":"3fd3b806.3e5988","wires":[]},{"id":"2761c6df.41b09a","type":"record","name":"Log error","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"level\" value=\"error\"/>\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"record\" value=\"`$event-message`\"/>\n","comments":"","outputs":1,"x":2331.1519775390625,"y":1905.912133216858,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"bc22b70f.0c2028","type":"execute","name":"OutputMessageBuilder","xml":"<execute plugin='org.openecomp.appc.dg.common.OutputMessagePlugin' method='outputMessageBuilder' >\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n<parameter name=\"event-message\" value=\"`$event-message`\" />","comments":"","outputs":1,"x":2721.7694702148438,"y":1948.0997314453125,"z":"3fd3b806.3e5988","wires":[["52451ef0.748c5"]]},{"id":"1601f900.8eba77","type":"block","name":"block","xml":"<block>\n","atomic":"false","comments":"","outputs":1,"x":2080.389019012451,"y":1922.388557434082,"z":"3fd3b806.3e5988","wires":[["f44e0dc2.7f05c","2761c6df.41b09a","bc22b70f.0c2028"]]},{"id":"98dcf986.aced38","type":"record","name":"Log message","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"level\" value=\"debug\"/>\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"record\" value=\"`'Restart succeed for the server : ' + $vm[$vmIndex].url`\"/>\n","comments":"","outputs":1,"x":1777.4445190429688,"y":1334.6119995117188,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"f4113929.049f68","type":"set","name":"Initialize_restartedFirstList_Count","xml":"<set>\n<parameter name='restartedFirstVMListCount' value='0' />\n\n","comments":"","x":692.1666870117188,"y":1264.0274658203125,"z":"3fd3b806.3e5988","wires":[]},{"id":"fcff96c4.ade008","type":"set","name":"Initialize_restart_parameters","xml":"<set>\n<parameter name='restartFailedCount' value='0' />\n<parameter name='restartSuccessCount' value='0' />","comments":"","x":709.7500915527344,"y":971.4163818359375,"z":"3fd3b806.3e5988","wires":[]},{"id":"bbe6528e.9f013","type":"switchNode","name":"If_any_restart_failed","xml":"<switch test='`$restartFailedCount>=1`'>\n","comments":"","outputs":1,"x":626.250078201294,"y":2505.583155632019,"z":"3fd3b806.3e5988","wires":[["2ac4791e.46f246","159116ac.51a699"]]},{"id":"2ac4791e.46f246","type":"outcomeTrue","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":892.5556812286377,"y":2452.305316925049,"z":"3fd3b806.3e5988","wires":[["7a649831.9f1858"]]},{"id":"159116ac.51a699","type":"outcomeFalse","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":899.750078201294,"y":2556.583148956299,"z":"3fd3b806.3e5988","wires":[["37709497.487aec"]]},{"id":"37709497.487aec","type":"returnSuccess","name":"return success","xml":"<return status='success'>\n\n","comments":"","x":1123.000078201294,"y":2557.083148956299,"z":"3fd3b806.3e5988","wires":[]},{"id":"7a649831.9f1858","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n","comments":"","x":1102.3056201934814,"y":2451.832904815674,"z":"3fd3b806.3e5988","wires":[]},{"id":"9c2d1d30.44395","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1107.7500610351562,"y":1380.6666259765625,"z":"3fd3b806.3e5988","wires":[["e32d3076.62496","9c6ca981.cf3198","9a0c3b86.dcc888"]]},{"id":"e32d3076.62496","type":"for","name":"for_each_vm","xml":"<for index='i' start='0' end='`$restartSuccessCount`' >","comments":"","outputs":1,"x":1339.2500610351562,"y":1382.4166259765625,"z":"3fd3b806.3e5988","wires":[["c4ab230a.95c29"]]},{"id":"c4ab230a.95c29","type":"set","name":"set","xml":"<set>\n<parameter name=\"healthcheck.vm[$i].url\" value=\"`$restartedServerList[$i].url`\" />\n","comments":"","x":1524.2500610351562,"y":1377.9166259765625,"z":"3fd3b806.3e5988","wires":[]},{"id":"9a0c3b86.dcc888","type":"set","name":"set","xml":"<set>\n<parameter name=\"healthcheck.vmCount\" value=\"`$restartSuccessCount`\" />\n<parameter name=\"retry-healthcheck\" value=\"true\"/>\n","comments":"","x":1358.5000610351562,"y":1439.4166259765625,"z":"3fd3b806.3e5988","wires":[]},{"id":"9c6ca981.cf3198","type":"call","name":"call_vnfc_healthcheck_dg","xml":"<call rpc='`$HealthCheckDG.dg_name`' version='`$HealthCheckDG.dg_version`' module='`$HealthCheckDG.dg_module`' mode='sync' >\n","comments":"","outputs":1,"x":1400.8048706054688,"y":1493.89990234375,"z":"3fd3b806.3e5988","wires":[["e30a91c0.1f657","d32c2422.06b3d8","d703536.35151b"]]},{"id":"e30a91c0.1f657","type":"outcome","name":"healthcheck_failed","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1711.2500610351562,"y":1495.4166259765625,"z":"3fd3b806.3e5988","wires":[["e2ffb1de.b124e"]]},{"id":"d32c2422.06b3d8","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1706.7665405273438,"y":1554.7547607421875,"z":"3fd3b806.3e5988","wires":[["3298d778.916828"]]},{"id":"d703536.35151b","type":"outcome","name":"healthcheck_success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1687.5000610351562,"y":1623.1666259765625,"z":"3fd3b806.3e5988","wires":[["2bd9fac.f2e7606"]]},{"id":"2bd9fac.f2e7606","type":"for","name":"for_each_vm","xml":"<for index=\"i\" start=\"0\" end=\"`$restartSuccessCount`\" >","comments":"","outputs":1,"x":1905.4168090820312,"y":1686.4166259765625,"z":"3fd3b806.3e5988","wires":[["c4c4885d.681c88"]]},{"id":"c4c4885d.681c88","type":"switchNode","name":"switch : healthcheck status","xml":"<switch test=\"`$healthcheck.vm[$i].status`\">\n","comments":"","outputs":1,"x":2161.5001831054688,"y":1693.9166259765625,"z":"3fd3b806.3e5988","wires":[["2e9fc35d.edaf5c","66adef5.39ab51","49abe035.4ef46"]]},{"id":"ef47ba9d.0acfa8","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":992.9722766876221,"y":2186.916627883911,"z":"3fd3b806.3e5988","wires":[["f26ebaaf.f84c68","c45137da.947918","cb92c687.45d9b8"]]},{"id":"f26ebaaf.f84c68","type":"for","name":"for_each_vm","xml":"<for index='i' start='0' end='`$restartSuccessCount`' >","comments":"","outputs":1,"x":1166.222276687622,"y":2133.166626930237,"z":"3fd3b806.3e5988","wires":[["47769042.b3fd5"]]},{"id":"cb92c687.45d9b8","type":"set","name":"set","xml":"<set>\n<parameter name=\"healthcheck.vmCount\" value=\"`$restartSuccessCount`\" />\n<parameter name=\"retry-healthcheck\" value=\"true\"/>\n","comments":"","x":1192.4722805023193,"y":2191.6665058135986,"z":"3fd3b806.3e5988","wires":[]},{"id":"c45137da.947918","type":"call","name":"call_vnfc_healthcheck_dg","xml":"<call rpc='`$HealthCheckDG.dg_name`' version='`$HealthCheckDG.dg_version`' module='`$HealthCheckDG.dg_module`' mode='sync' >\n","comments":"","outputs":1,"x":1173.276964187622,"y":2258.1499042510986,"z":"3fd3b806.3e5988","wires":[["fbea3fd2.46312","c08ecaf2.836998","5bf097d5.7d4a38"]]},{"id":"fbea3fd2.46312","type":"outcome","name":"healthcheck_failed","xml":"<outcome value='failure'>\n","comments":"","outputs":1,"x":1432.4722805023193,"y":2197.666627883911,"z":"3fd3b806.3e5988","wires":[["7c565f0f.63661"]]},{"id":"c08ecaf2.836998","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1443.4889698028564,"y":2250.0048265457153,"z":"3fd3b806.3e5988","wires":[["21eda6fd.da801a"]]},{"id":"5bf097d5.7d4a38","type":"outcome","name":"healthcheck_success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":1449.2223682403564,"y":2321.416569709778,"z":"3fd3b806.3e5988","wires":[["29bda719.f445f8"]]},{"id":"ed661fb6.7a7a3","type":"set","name":"set_mark_vm_restarted","xml":"<set>\n<parameter name=\"restartedServerList[$restartSuccessCount].url\" value=\"`$vm[$vmIndex].url`\" />\n","comments":"","x":1788.5276336669922,"y":1240.5278930664062,"z":"3fd3b806.3e5988","wires":[]},{"id":"3ee9ae0.e12b052","type":"set","name":"increment_restarted_vm_count","xml":"<set>\n<parameter name='restartSuccessCount' value='`$restartSuccessCount+1`' />\n","comments":"","x":1813.7740478515625,"y":1286.6627807617188,"z":"3fd3b806.3e5988","wires":[]},{"id":"fd9f91c4.d80c9","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1535.4167938232422,"y":1239.6115112304688,"z":"3fd3b806.3e5988","wires":[["98dcf986.aced38","ed661fb6.7a7a3","3ee9ae0.e12b052"]]},{"id":"3298d778.916828","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1890.1111450195312,"y":1553.4442138671875,"z":"3fd3b806.3e5988","wires":[["e42b2698.ff0c28","d6472f50.eeb0f","66766044.0bc98","f286d57a.a53198"]]},{"id":"f286d57a.a53198","type":"set","name":"Set event message","xml":"<set>\n<parameter name='event-message' value=\"VNFC Health check DG not found\"/>","comments":"","x":2182.7781372070312,"y":1504.4442138671875,"z":"3fd3b806.3e5988","wires":[]},{"id":"66766044.0bc98","type":"record","name":"Log event","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"level\" value=\"error\"/>\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"record\" value=\"`$event-message`\"/>\n","comments":"","outputs":1,"x":2180.2444458007812,"y":1546.2568359375,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"e42b2698.ff0c28","type":"execute","name":"OutputMessageBuilder","xml":"<execute plugin='org.openecomp.appc.dg.common.OutputMessagePlugin' method='outputMessageBuilder' >\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n<parameter name=\"event-message\" value=\"`$event-message`\" />","comments":"","outputs":1,"x":2203.1113891601562,"y":1588.4442138671875,"z":"3fd3b806.3e5988","wires":[["52451ef0.748c5"]]},{"id":"d6472f50.eeb0f","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n","comments":"","x":2176.6221313476562,"y":1630.3822021484375,"z":"3fd3b806.3e5988","wires":[]},{"id":"e2ffb1de.b124e","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1922.1111450195312,"y":1495.4442138671875,"z":"3fd3b806.3e5988","wires":[["66766044.0bc98","e42b2698.ff0c28","d6472f50.eeb0f","7fe2609.cd44ea"]]},{"id":"7fe2609.cd44ea","type":"set","name":"Set event message","xml":"<set>\n<parameter name='event-message' value=\"Error occured during health check of the Restarted servers\"/>","comments":"","x":2182.3613891601562,"y":1459.4442138671875,"z":"3fd3b806.3e5988","wires":[]},{"id":"49abe035.4ef46","type":"other","name":"outcome_up","xml":"<outcome value='UP'>\n","comments":"","outputs":1,"x":2390.7504272460938,"y":1749.7222900390625,"z":"3fd3b806.3e5988","wires":[["8ae3ec83.85715"]]},{"id":"8ae3ec83.85715","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2611.0006713867188,"y":1747.2222900390625,"z":"3fd3b806.3e5988","wires":[["1fc212be.5390ed","4a8cea9d.531f74","ae266efa.9b164"]]},{"id":"1fc212be.5390ed","type":"execute","name":"Report_Success","xml":"<execute plugin='org.openecomp.appc.dg.common.DCAEReporterPlugin' method='reportSuccess' >\n<parameter name=\"event-message\" value=\"`$success-message`\" />\n","comments":"","outputs":1,"x":2848.7504272460938,"y":1837.7939453125,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"4a8cea9d.531f74","type":"record","name":"Log message","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"level\" value=\"debug\"/>\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"record\" value=\"`$success-message`\"/>\n","comments":"","outputs":1,"x":2849.8053588867188,"y":1793.2889404296875,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"ae266efa.9b164","type":"set","name":"Set success message and update counters","xml":"<set>\n<parameter name='success-message' value=\"`'Restart succeeded for the server : ' + $restartedServerList[$i].url`\"/>\n<parameter name='restartedFirstVMListCount' value='`$restartedFirstVMListCount+1`' />\n<parameter name=\"RestartSuccessVMCount\" value=\"`$RestartSuccessVMCount + 1`\" />\n\n","comments":"","x":2923.8053588867188,"y":1748.2890625,"z":"3fd3b806.3e5988","wires":[]},{"id":"2e9fc35d.edaf5c","type":"other","name":"outcome_down","xml":"<outcome value='DOWN'>\n","comments":"","outputs":1,"x":2400.7501831054688,"y":1640.72216796875,"z":"3fd3b806.3e5988","wires":[["722f7db.ad64184"]]},{"id":"66adef5.39ab51","type":"other","name":"outcome_unknown","xml":"<outcome value='UNKNOWN'>\n","comments":"","outputs":1,"x":2414.5336303710938,"y":1696.8648681640625,"z":"3fd3b806.3e5988","wires":[["722f7db.ad64184"]]},{"id":"722f7db.ad64184","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2626.7147827148438,"y":1643.5078125,"z":"3fd3b806.3e5988","wires":[["2420dfd1.3d3f6","6aea1090.d7e6b","f6a19c69.5f799"]]},{"id":"2420dfd1.3d3f6","type":"set","name":"Set event message and update Counters","xml":"<set>\n<parameter name='event-message' value=\"`'Health check failed for the Restarted server : ' + $restartedServerList[$i].url`\"/>\n<parameter name=\"restartFailedCount\" value=\"`$restartFailedCount + 1`\" />\n<parameter name=\"healthCheckFailedCount\" value=\"`$healthCheckFailedCount + 1`\" />\n","comments":"","x":2914.7147827148438,"y":1596.508056640625,"z":"3fd3b806.3e5988","wires":[]},{"id":"6aea1090.d7e6b","type":"record","name":"Log event","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"level\" value=\"error\"/>\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"record\" value=\"`$event-message`\"/>\n","comments":"","outputs":1,"x":2842.6610717773438,"y":1643.1077880859375,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"f6a19c69.5f799","type":"execute","name":"OutputMessageBuilder","xml":"<execute plugin='org.openecomp.appc.dg.common.OutputMessagePlugin' method='outputMessageBuilder' >\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n<parameter name=\"event-message\" value=\"`$event-message`\" />","comments":"","outputs":1,"x":2858.5282592773438,"y":1685.2952880859375,"z":"3fd3b806.3e5988","wires":[["52451ef0.748c5"]]},{"id":"202bd856.91c528","type":"comment","name":"Restart First List","info":"","comments":"","x":497.66676330566406,"y":1078.333251953125,"z":"3fd3b806.3e5988","wires":[]},{"id":"ded1e319.f55dd","type":"comment","name":"Healthcheck First List","info":"","comments":"","x":701.77783203125,"y":1379.9166259765625,"z":"3fd3b806.3e5988","wires":[]},{"id":"3676ee92.49abb2","type":"comment","name":"Restart Second List","info":"","comments":"","x":681.1111679077148,"y":1722.9163818359375,"z":"3fd3b806.3e5988","wires":[]},{"id":"72122241.50003c","type":"comment","name":"Healthcheck SecondList","info":"","comments":"","x":703.19455909729,"y":2140.027466773987,"z":"3fd3b806.3e5988","wires":[]},{"id":"e035a23b.7b864","type":"record","name":"Log message","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"level\" value=\"debug\"/>\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"record\" value=\"`'Restart succeeded for the server : ' + $vm[$vmIndex].url`\"/>\n","comments":"","outputs":1,"x":2313.083854675293,"y":2155.361406326294,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"58515fa3.8d588","type":"set","name":"set_mark_vm_restarted","xml":"<set>\n<parameter name=\"restartedServerList[$restartSuccessCount].url\" value=\"`$vm[$vmIndex].url`\" />\n","comments":"","x":2366.667251586914,"y":2062.777953624725,"z":"3fd3b806.3e5988","wires":[]},{"id":"a242df26.53c36","type":"set","name":"increment_restarted_vm_count","xml":"<set>\n<parameter name='restartSuccessCount' value='`$restartSuccessCount+1`' />\n","comments":"","x":2342.663101196289,"y":2105.4125971794124,"z":"3fd3b806.3e5988","wires":[]},{"id":"a762c339.2cf29","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2082.8056640625,"y":2106.1110653877254,"z":"3fd3b806.3e5988","wires":[["e035a23b.7b864","58515fa3.8d588","a242df26.53c36"]]},{"id":"47769042.b3fd5","type":"set","name":"set","xml":"<set>\n<parameter name=\"healthcheck.vm[$i].url\" value=\"`$restartedServerList[$i].url`\" />\n","comments":"","x":1429.8610744476318,"y":2136.6943378448486,"z":"3fd3b806.3e5988","wires":[]},{"id":"21eda6fd.da801a","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1633.6666202545166,"y":2251.3887977600098,"z":"3fd3b806.3e5988","wires":[["11eddd5.8a0d223","1627b80.c24f648","448eea91.f58eb4","51d1e08a.45697"]]},{"id":"51d1e08a.45697","type":"set","name":"Set event message","xml":"<set>\n<parameter name='event-message' value=\"VNFC Health check DG not found\"/>","comments":"","x":1892.8333759307861,"y":2237.888620376587,"z":"3fd3b806.3e5988","wires":[]},{"id":"448eea91.f58eb4","type":"record","name":"Log event","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"level\" value=\"error\"/>\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"record\" value=\"`$event-message`\"/>\n","comments":"","outputs":1,"x":1908.2995624542236,"y":2300.451364517212,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"11eddd5.8a0d223","type":"execute","name":"OutputMessageBuilder","xml":"<execute plugin='org.openecomp.appc.dg.common.OutputMessagePlugin' method='outputMessageBuilder' >\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n<parameter name=\"event-message\" value=\"`$event-message`\" />","comments":"","outputs":1,"x":2569.1669311523438,"y":2206.8887939453125,"z":"3fd3b806.3e5988","wires":[["52451ef0.748c5"]]},{"id":"1627b80.c24f648","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n","comments":"","x":1907.9274921417236,"y":2366.0767879486084,"z":"3fd3b806.3e5988","wires":[]},{"id":"7c565f0f.63661","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1637.6666202545166,"y":2198.3887977600098,"z":"3fd3b806.3e5988","wires":[["448eea91.f58eb4","11eddd5.8a0d223","1627b80.c24f648","37b0d881.eecf48"]]},{"id":"37b0d881.eecf48","type":"set","name":"Set event message","xml":"<set>\n<parameter name='event-message' value=\"Error occured during health check of the restarted servers\"/>","comments":"","x":1926.1666278839111,"y":2167.888864517212,"z":"3fd3b806.3e5988","wires":[]},{"id":"29bda719.f445f8","type":"for","name":"for_each_vm","xml":"<for index=\"i\" start=\"0\" end=\"`$restartSuccessCount`\" >","comments":"","outputs":1,"x":1421.611177444458,"y":2438.1107234954834,"z":"3fd3b806.3e5988","wires":[["1cf0221.15704de"]]},{"id":"1cf0221.15704de","type":"switchNode","name":"switch : healthcheck status","xml":"<switch test=\"`$healthcheck.vm[$i].status`\">\n","comments":"","outputs":1,"x":1641.2221240997314,"y":2440.9440364837646,"z":"3fd3b806.3e5988","wires":[["78917505.3d9e0c","309b8ddd.a96422","aaa07653.033a58"]]},{"id":"aaa07653.033a58","type":"other","name":"outcome_up","xml":"<outcome value='UP'>\n","comments":"","outputs":1,"x":1986.9721698760986,"y":2570.749397277832,"z":"3fd3b806.3e5988","wires":[["f1e0d6b3.20cc08"]]},{"id":"f1e0d6b3.20cc08","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2232.972291946411,"y":2571.749274253845,"z":"3fd3b806.3e5988","wires":[["34f66625.125b7a","3eee9a01.5d0826","3502f29e.fa060e"]]},{"id":"34f66625.125b7a","type":"execute","name":"Report_Success","xml":"<execute plugin='org.openecomp.appc.dg.common.DCAEReporterPlugin' method='reportSuccess' >\n<parameter name=\"event-message\" value=\"`$success-message`\" />","comments":"","outputs":1,"x":2558.9724254608154,"y":2643.82080745697,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"3eee9a01.5d0826","type":"record","name":"Log message","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"level\" value=\"debug\"/>\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"record\" value=\"`$success-message`\"/>\n","comments":"","outputs":1,"x":2553.027109146118,"y":2599.31592464447,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"3502f29e.fa060e","type":"set","name":"Set success message","xml":"<set>\n<parameter name='success-message' value=\"`'Restart succeeded for the server : ' + $restartedServerList[$i].url`\"/>\n<parameter name=\"RestartSuccessVMCount\" value=\"`$RestartSuccessVMCount + 1`\" />\n","comments":"","x":2552.0271129608154,"y":2551.316167831421,"z":"3fd3b806.3e5988","wires":[]},{"id":"78917505.3d9e0c","type":"other","name":"outcome_down","xml":"<outcome value='DOWN'>\n","comments":"","outputs":1,"x":1990.9720478057861,"y":2439.749397277832,"z":"3fd3b806.3e5988","wires":[["a5c41de1.d7dfd"]]},{"id":"309b8ddd.a96422","type":"other","name":"outcome_unknown","xml":"<outcome value='UNKNOWN'>\n","comments":"","outputs":1,"x":1989.7556171417236,"y":2491.892219543457,"z":"3fd3b806.3e5988","wires":[["a5c41de1.d7dfd"]]},{"id":"a5c41de1.d7dfd","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2233.686647415161,"y":2457.034918785095,"z":"3fd3b806.3e5988","wires":[["82a52a17.726898","473fa11c.d8f88","d56783d5.be2b6"]]},{"id":"82a52a17.726898","type":"set","name":"Set event message and update counters","xml":"<set>\n<parameter name='event-message' value=\"`'Health check failed for the Restarted server : ' + $restartedServerList[$i].url`\"/>\n<parameter name=\"restartFailedCount\" value=\"`$restartFailedCount + 1`\" />\n<parameter name=\"healthCheckFailedCount\" value=\"`$healthCheckFailedCount + 1`\" />\n","comments":"","x":2527.6867065429688,"y":2394.535400390625,"z":"3fd3b806.3e5988","wires":[]},{"id":"473fa11c.d8f88","type":"record","name":"Log event","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"level\" value=\"error\"/>\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"record\" value=\"`$event-message`\"/>\n","comments":"","outputs":1,"x":2496.633062362671,"y":2445.1352586746216,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"d56783d5.be2b6","type":"execute","name":"OutputMessageBuilder","xml":"<execute plugin='org.openecomp.appc.dg.common.OutputMessagePlugin' method='outputMessageBuilder' >\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n<parameter name=\"event-message\" value=\"`$event-message`\" />","comments":"","outputs":1,"x":2520.499765396118,"y":2496.3225145339966,"z":"3fd3b806.3e5988","wires":[["52451ef0.748c5"]]},{"id":"3a78a34c.56b16c","type":"set","name":"Re Initialize_restart_success_count","xml":"<set>\n<parameter name='restartSuccessCount' value='0' />","comments":"","x":684.7499847412109,"y":1611.0831298828125,"z":"3fd3b806.3e5988","wires":[]},{"id":"1ba5abd.58e3954","type":"switchNode","name":"switch_any_vm_to_healthcheck","xml":"<switch test='`$restartSuccessCount>=1`'>\n","comments":"","outputs":1,"x":718.5000400543213,"y":2188.166627883911,"z":"3fd3b806.3e5988","wires":[["aedcde25.7a86b","76918471.5d839c"]]},{"id":"aedcde25.7a86b","type":"other","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":883.5000457763672,"y":2136.6666259765625,"z":"3fd3b806.3e5988","wires":[["ef47ba9d.0acfa8"]]},{"id":"76918471.5d839c","type":"outcomeTrue","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":889.5000171661377,"y":2284.166569709778,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"c5cfc802.b4cf68","type":"switchNode","name":"switch_any_vm_to_healthcheck","xml":"<switch test='`$restartSuccessCount>=1`'>\n","comments":"","outputs":1,"x":672.5000610351562,"y":1447.1666259765625,"z":"3fd3b806.3e5988","wires":[["a643ee70.b4dd9","adcaa36a.61cef"]]},{"id":"a643ee70.b4dd9","type":"other","name":"true","xml":"<outcome value='true'>\n","comments":"","outputs":1,"x":921.5,"y":1381.4166259765625,"z":"3fd3b806.3e5988","wires":[["9c2d1d30.44395"]]},{"id":"adcaa36a.61cef","type":"outcomeTrue","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":910.7499847412109,"y":1508.1666259765625,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"66b6402.a4e8bc","type":"block","name":"block","xml":"<block>","atomic":"true","comments":"","outputs":1,"x":927.9722900390625,"y":1083.0560913085938,"z":"3fd3b806.3e5988","wires":[["2c8da896.df9298","7c143892.7a48a8","6fce4d93.f36c94"]]},{"id":"2c8da896.df9298","type":"record","name":"Log message","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"level\" value=\"debug\"/>\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"record\" value=\"`'Attempting to restart the server : ' + $vm[$vmIndex].url`\"/>\n","comments":"","outputs":1,"x":1102.4011840820312,"y":1025.2701416015625,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"6fce4d93.f36c94","type":"set","name":"set restart parameters","xml":"<set>\n<parameter name=\"restart-vm-url\" value=\"`$vm[$vmIndex].url`\" />\n<parameter name='restartRetryCount' value='3'/>\n<parameter name='application-node-name' value=\"`$vm[$vmIndex].node-name`\"/>\n<parameter name='application-status ' value=\"`$vm[$vmIndex].status`\"/>\n","comments":"","x":1130.8120346069336,"y":1082.4486465454102,"z":"3fd3b806.3e5988","wires":[]},{"id":"7c143892.7a48a8","type":"call","name":"Restart_VM","xml":"<call module='APPC' rpc='Restart_VM' mode='sync' >\n","comments":"","outputs":1,"x":1090.5618286132812,"y":1146.4487915039062,"z":"3fd3b806.3e5988","wires":[["25ad81f2.75882e","4d653382.a429ec","ced444de.57c2f8"]]},{"id":"47f00996.18f8a8","type":"block","name":"block","xml":"<block>","atomic":"true","comments":"","outputs":1,"x":1480.5556259155273,"y":1864.7220458984375,"z":"3fd3b806.3e5988","wires":[["ed660e4a.df05a","4a73526b.75205c","4a729f7d.1e76c"]]},{"id":"ed660e4a.df05a","type":"record","name":"Log message","xml":"<record plugin=\"org.onap.ccsdk.sli.core.sli.recording.Slf4jRecorder\">\n<parameter name=\"level\" value=\"debug\"/>\n<parameter name=\"logger\" value=\"message-log\"/>\n<parameter name=\"record\" value=\"`'Attempting to restart the server : ' + $vm[$vmIndex].url`\"/>\n","comments":"","outputs":1,"x":1673.2345809936523,"y":1797.6864013671875,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"4a73526b.75205c","type":"call","name":"Restart_VM","xml":"<call module='APPC' rpc='Restart_VM' mode='sync' >\n","comments":"","outputs":1,"x":1655.6453857421875,"y":1970.364990234375,"z":"3fd3b806.3e5988","wires":[["b7d474af.5c9d58","48e8232b.a696ec","61c3630a.cc9c9c"]]},{"id":"ced444de.57c2f8","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1368.4495239257812,"y":1071.4140014648438,"z":"3fd3b806.3e5988","wires":[["7ad527cc.c40e28"]]},{"id":"7ad527cc.c40e28","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1541.4495239257812,"y":1072.4140014648438,"z":"3fd3b806.3e5988","wires":[["33b4c1af.2c1a5e","e4f324e3.458468","5abc7a5f.2be054","6fb4cf51.1634b"]]},{"id":"5abc7a5f.2be054","type":"set","name":"Set event message and Mark VM failed","xml":"<set>\n<parameter name='event-message' value=\"`'DG to execute Restart action not found for VM: ' + $vm[$vmIndex].url`\"/>\n<parameter name=\"restartFailedCount\" value=\"`$restartFailedCount + 1`\" />\n","comments":"","x":1843.520767211914,"y":1007.8781733512874,"z":"3fd3b806.3e5988","wires":[]},{"id":"61c3630a.cc9c9c","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":1854.1993980407715,"y":1973.4134702682495,"z":"3fd3b806.3e5988","wires":[["8fddaeff.19854"]]},{"id":"8fddaeff.19854","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":2096.6993522644043,"y":1976.9134912490845,"z":"3fd3b806.3e5988","wires":[["2761c6df.41b09a","bc22b70f.0c2028","df04b667.517118","65123b76.9ed874"]]},{"id":"df04b667.517118","type":"set","name":"Set event message and Mark VM failed","xml":"<set>\n<parameter name='event-message' value=\"`'DG to execute Restart action not found for VM: ' + $vm[$vmIndex].url`\"/>\n<parameter name=\"restartFailedCount\" value=\"`$restartFailedCount + 1`\" />\n","comments":"","x":2416.5051879882812,"y":1852.16357421875,"z":"3fd3b806.3e5988","wires":[]},{"id":"36d8fdb0.8d2aa2","type":"outcomeTrue","name":"false","xml":"<outcome value='false'>\n","comments":"","outputs":1,"x":1148.3214263916016,"y":720.1786422729492,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"6b9137e6.eeb0c8","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1146.6071472167969,"y":815.4643859863281,"z":"3fd3b806.3e5988","wires":[["30d0cd36.793752","3be108bc.20f958","691ca8da.821e88"]]},{"id":"96ac29bf.e4a348","type":"not-found","name":"not-found","xml":"<outcome value='not-found'>\n","comments":"","outputs":1,"x":948.0358581542969,"y":846.4644470214844,"z":"3fd3b806.3e5988","wires":[["6b9137e6.eeb0c8"]]},{"id":"6c87077e.9e46d8","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":669.7500457763672,"y":497.0357036590576,"z":"3fd3b806.3e5988","wires":[["5124c756.7348b8","e598a9ef.046f68","60571aaf.8d8604"]]},{"id":"52451ef0.748c5","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":3488.7737426757812,"y":1440.0001220703125,"z":"3fd3b806.3e5988","wires":[["9a608560.1a75b8"]]},{"id":"9a608560.1a75b8","type":"execute","name":"Report_Error_To_DCAE","xml":"<execute plugin='org.openecomp.appc.dg.common.DCAEReporterPlugin' method='report' >\n<parameter name=\"event-message\" value=\"`$event-message`\" />","comments":"","outputs":1,"x":4340.773887634277,"y":1641.0000228881836,"z":"3fd3b806.3e5988","wires":[["929c559b.07cf48"]]},{"id":"929c559b.07cf48","type":"success","name":"success","xml":"<outcome value='success'>\n","comments":"","outputs":1,"x":4667.059288024902,"y":1618.4287338256836,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"1f3a0577.6a147b","type":"execute","name":"OutputMessageBuilder","xml":"<execute plugin='org.openecomp.appc.dg.common.OutputMessagePlugin' method='outputMessageBuilder' >\n<parameter name=\"error-message\" value=\"`$error-message`\" />\n<parameter name=\"event-message\" value=\"`$event-message`\" />","comments":"","outputs":1,"x":2343.4407348632812,"y":835.0000610351562,"z":"3fd3b806.3e5988","wires":[["52451ef0.748c5"]]},{"id":"794de1af.7fd7e","type":"block","name":"block : atomic","xml":"<block atomic='true'>","atomic":"true","comments":"","outputs":1,"x":1058.2222137451172,"y":499.66662406921387,"z":"3fd3b806.3e5988","wires":[["5ef368c3.4bd7b8","63f52d2.4830bd4"]]},{"id":"63f52d2.4830bd4","type":"set","name":"set VM status","xml":"<set>\n<parameter name=\"vm[$i].status\" value=\"`$healthcheck.vm[$i].status`\" />\n<parameter name=\"vm[$i].node-name\" value=\"`$healthcheck.vm[$i].nodeName`\" />\n","comments":"","x":1267.22216796875,"y":433.6666259765625,"z":"3fd3b806.3e5988","wires":[]},{"id":"38e206a3.cc06fa","type":"switchNode","name":"Order ?","xml":"<switch test='`$vm[$vmIndex].order`'>\n","comments":"","outputs":1,"x":637.2222442626953,"y":1122.2225341796875,"z":"3fd3b806.3e5988","wires":[["a8c2ec5e.735c3","68251e28.9d153"]]},{"id":"a8c2ec5e.735c3","type":"other","name":"first","xml":"<outcome value='first'>\n","comments":"","outputs":1,"x":792.2222442626953,"y":1082.4725952148438,"z":"3fd3b806.3e5988","wires":[["66b6402.a4e8bc"]]},{"id":"68251e28.9d153","type":"outcomeTrue","name":"second","xml":"<outcome value='second'>\n","comments":"","outputs":1,"x":783.4722290039062,"y":1169.2225952148438,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"90e673f0.925cf","type":"for","name":"for_first_list","xml":"<for index='vmIndex' start='0' end='`$vmCount`' >\n","comments":"","outputs":1,"x":1056.2222518920898,"y":1863.77783203125,"z":"3fd3b806.3e5988","wires":[["41e7de35.4909a"]]},{"id":"41e7de35.4909a","type":"switchNode","name":"Order ?","xml":"<switch test='`$vm[$vmIndex].order`'>\n","comments":"","outputs":1,"x":1202.6944198608398,"y":1865.8336181640625,"z":"3fd3b806.3e5988","wires":[["9f13b01a.2bea1","24e3bd72.508902"]]},{"id":"9f13b01a.2bea1","type":"other","name":"first","xml":"<outcome value='first'>\n","comments":"","outputs":1,"x":1364.6942977905273,"y":1779.083740234375,"z":"3fd3b806.3e5988","wires":[[]]},{"id":"24e3bd72.508902","type":"outcomeTrue","name":"second","xml":"<outcome value='second'>\n","comments":"","outputs":1,"x":1342.9442977905273,"y":1864.8336181640625,"z":"3fd3b806.3e5988","wires":[["47f00996.18f8a8"]]},{"id":"4a729f7d.1e76c","type":"set","name":"set restart parameters","xml":"<set>\n<parameter name=\"restart-vm-url\" value=\"`$vm[$vmIndex].url`\" />\n<parameter name='restartRetryCount' value='3'/>\n<parameter name='application-node-name' value=\"`$vm[$vmIndex].node-name`\"/>\n<parameter name='application-status ' value=\"`$vm[$vmIndex].status`\"/>\n","comments":"","x":1692.222412109375,"y":1864.5555419921875,"z":"3fd3b806.3e5988","wires":[]},{"id":"6fb4cf51.1634b","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n<parameter name='error-code' value='401' />\n<parameter name='error-message' value='`$error-message`' />\n<parameter name='output.status.code' value='401'/>\n","comments":"","x":1798.599868774414,"y":1193.8249506950374,"z":"3fd3b806.3e5988","wires":[]},{"id":"65123b76.9ed874","type":"returnFailure","name":"return failure","xml":"<return status='failure'>\n","comments":"","x":2282.600112915039,"y":2015.8249506950374,"z":"3fd3b806.3e5988","wires":[]}]
